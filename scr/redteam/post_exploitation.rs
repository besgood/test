use crate::redteam::c2::C2Session;

pub fn suggest_post_exploitation(session: &C2Session) -> Vec<String> {
    let mut suggestions = vec![];

    if session.privileges.contains("admin") {
        suggestions.push("Dump SAM database".into());
        suggestions.push("Install persistence via registry run key".into());
    } else {
        suggestions.push("Token impersonation attempt".into());
        suggestions.push("Search for plaintext creds in memory".into());
    }

    suggestions.push("Check for lateral movement via WMI".into());
    suggestions.push(format!("Enumerate shares on {}", session.target_ip));

    suggestions
}
